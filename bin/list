#!/usr/bin/env tclsh
# Link a fossil repository (url) to a local git repository for mirroring.

# @@ Meta Begin
# Application bin/list ?
# Meta author      ?
# Meta category    ?
# Meta description ?
# Meta location    http:/core.tcl.tk/akupries/fossil2git
# Meta platform    tcl
# Meta require     ?
# Meta subject     ?
# Meta summary     ?
# @@ Meta End

package require Tcl 8.5
package require fileutil

proc main {} {
    do {*}[cmdline]
    return
}

proc cmdline {} {
    global argv
    if {[llength $argv] != 1} { usage }
    return $argv
}

proc usage {} {
    global argv0
    puts stderr "Usage: $argv0 statedir"
    exit 1
}

proc do {statedir} {
    # Keep in sync with setup-local
    set src $statedir/in

    foreach r [glob -nocomplain -directory $src -tails *.fossil] {
	puts [file rootname $r]
    }
    return
}

main
exit
